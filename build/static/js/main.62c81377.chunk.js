(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{206:function(e,t,n){e.exports=n(362)},362:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(37),u=n.n(c),l=n(23),o=n(8),i=n.n(o),s=n(16),f=n(22),p=n(26),m=n.n(p),d=function(e,t){var n=Object(a.useState)(""),r=Object(f.a)(n,2),c=r[0],u=r[1];return[{type:e,name:t,value:c,onChange:function(e){u(e.target.value)}},function(){u("")}]},b=null,v=function(e){var t=Object(a.useState)([]),n=Object(f.a)(t,2),r=n[0],c=n[1],u=function(){var t=Object(s.a)(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get(e);case 2:n=t.sent,c(n.data);case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),l=function(){var t=Object(s.a)(i.a.mark(function t(n){var a,u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={headers:{Authorization:b}},t.next=3,m.a.post(e,n,a);case 3:u=t.sent,c(r.concat(u.data));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),o=function(){var t=Object(s.a)(i.a.mark(function t(n,a){var u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.put("".concat(e,"/").concat(n),a);case 2:u=t.sent,c(r.map(function(e){return e.id!==n?e:u.data}));case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),p=function(){var t=Object(s.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={headers:{Authorization:b}},t.next=3,m.a.delete("".concat(e,"/").concat(n),a);case 3:c(r.filter(function(e){return e.id!==n}));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return[r,{get:u,create:l,update:o,remove:p,setToken:function(e){b="bearer ".concat(e)}}]},E=Object(l.b)(function(e){return{message:e.notification}})(function(e){var t=e.message;return null===t?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,t))}),g={login:function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},h=null,w={getAll:function(){return m.a.get("/api/blogs").then(function(e){return e.data})},create:function(){var e=Object(s.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,m.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){h="bearer ".concat(e)},update:function(){var e=Object(s.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(s.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,m.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(s.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("".concat("/api/blogs","/").concat(t,"/comments"),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},O=function(e){return{type:"SET_NOTIFICATION",data:e}},y=function(e,t){var n=Math.floor(1e3*t);return function(){var t=Object(s.a)(i.a.mark(function t(a){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(O(e)),t.next=3,setTimeout(function(){a({type:"SET_NOTIFICATION",data:null})},n);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;default:return e}},x=n(194),k=function(){return function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return[].concat(Object(x.a)(e),[t.data]);case"UPDATE_BLOG":var n=t.data.id,a=t.data;return e.map(function(e){return e.id!==n?e:a});case"REMOVE_BLOG":var r=t.data.id;return e.filter(function(e){return e.id!==r});default:return e}},S=function(e){return function(t){t({type:"SET_USER",data:e})}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},I=n(370),N=n(375),C={setNotification:y,setUser:S,initializeBlogs:k},U=Object(l.b)(null,C)(function(e){var t=d("text","username"),n=Object(f.a)(t,2),a=n[0],c=n[1],u=d("password","password"),l=Object(f.a)(u,2),o=l[0],p=l[1],m=function(){var t=Object(s.a)(i.a.mark(function t(n){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,g.login({username:a.value,password:o.value});case 4:r=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),e.setNotification("Login successful",3),e.setUser(r),w.setToken(r.token),e.initializeBlogs(),c(),p(),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(1),console.log(t.t0),e.setNotification("Wrong username or password",5);case 18:case"end":return t.stop()}},t,null,[[1,14]])}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(I.a,{onSubmit:m},r.a.createElement(I.a.Field,null,r.a.createElement("label",null,"username:"),r.a.createElement("input",Object.assign({},a,{"data-cy":"username"}))),r.a.createElement(I.a.Field,null,r.a.createElement("label",null,"password:"),r.a.createElement("input",Object.assign({},o,{"data-cy":"password"}))),r.a.createElement(N.a,{type:"submit"},"Login"))}),A=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement(U,null))},L=n(93),F=r.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),c=Object(f.a)(n,2),u=c[0],l=c[1],o={display:u?"none":""},i={display:u?"":"none"},s=function(){l(!u)};return Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:s}}),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement(N.a,{onClick:s},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement(N.a,{onClick:s},"cancel")))}),_=function(e){var t=e.addBlog,n=e.title,a=e.author,c=e.url;return r.a.createElement(I.a,{onSubmit:t},r.a.createElement(I.a.Field,null,r.a.createElement("label",null,"title:"),r.a.createElement("input",Object.assign({},n,{"data-cy":"title"}))),r.a.createElement(I.a.Field,null,r.a.createElement("label",null,"author:"),r.a.createElement("input",Object.assign({},a,{"data-cy":"author"}))),r.a.createElement(I.a.Field,null,r.a.createElement("label",null,"url:"),r.a.createElement("input",Object.assign({},c,{"data-cy":"url"}))),r.a.createElement(N.a,{type:"submit"},"create"))},R=function(e){return r.a.createElement(F,{buttonLabel:"new Blog",ref:e.blogFormRef},r.a.createElement(_,{addBlog:e.addBlog,title:Object(L.a)({},e.title),author:Object(L.a)({},e.author),url:Object(L.a)({},e.url)}))},z=n(39),G=n(373),D={setNotification:y,addBlog:function(e){return function(){var t=Object(s.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.create(e);case 2:a=t.sent,n({type:"CREATE_BLOG",data:a});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},H=Object(l.b)(function(e){return{blogs:e.blogs}},D)(function(e){var t=d("text","title"),n=Object(f.a)(t,2),a=n[0],c=n[1],u=d("text","author"),l=Object(f.a)(u,2),o=l[0],p=l[1],m=d("text","url"),b=Object(f.a)(m,2),v=b[0],E=b[1],g=r.a.createRef(),h=function(){var t=Object(s.a)(i.a.mark(function t(n){var r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),g.current.toggleVisibility();try{r={title:a.value,author:o.value,url:v.value},e.addBlog(r),c(),p(),E(),e.setNotification("A new blog ".concat(r.title," by ").concat(r.author," added"),5)}catch(u){console.log(u),e.setNotification("Something went wrong",5)}case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"blog app"),r.a.createElement(R,{addBlog:h,title:a,author:o,url:v,blogFormRef:g}),r.a.createElement(G.a,{divided:!0,relaxed:!0},e.blogs.map(function(e){return r.a.createElement(G.a.Item,{as:z.b,to:"/blogs/".concat(e.id),key:e.id},e.title," ",e.author)})))}),J=n(372),M={setNotification:y,setUser:S,updateBlog:function(e,t){return function(){var n=Object(s.a)(i.a.mark(function n(a){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,w.update(e,t);case 2:r=n.sent,a({type:"UPDATE_BLOG",data:r});case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},addComment:function(e,t){return function(){var n=Object(s.a)(i.a.mark(function n(a){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,w.addComment(e,{comment:t});case 2:r=n.sent,a({type:"UPDATE_BLOG",data:r});case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},P=Object(l.b)(function(e,t){return{blog:(n=t.id,a=e.blogs,a.find(function(e){return e.id===n}))};var n,a},M)(function(e){var t=d("text","comment"),n=Object(f.a)(t,2),a=n[0],c=n[1],u=e.blog;if(void 0===u)return null;var l=function(){var t=Object(s.a)(i.a.mark(function t(n){var a,r,c,u,l,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{a=n.user,r=n.likes,c=n.author,u=n.title,l=n.url,o={user:a.id,likes:r+1,author:c,title:u,url:l},e.updateBlog(n.id,o)}catch(i){console.log(i),e.setNotification("Something went wrong",5)}case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),o=function(){var t=Object(s.a)(i.a.mark(function t(n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{e.addComment(u.id,a.value),c(),e.setNotification("A new comment ".concat(a.value," added"),5)}catch(r){console.log(r),e.setNotification("Something went wrong",5)}case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(J.a,null,r.a.createElement(J.a.Content,null,r.a.createElement(J.a.Header,{as:"h2"},u.title),r.a.createElement(J.a.Meta,{as:"a",href:u.url},u.url),r.a.createElement(J.a.Description,null,r.a.createElement("span",null,u.likes," likes",r.a.createElement("button",{onClick:function(){return l(u)}},"like")),r.a.createElement("p",null,"added by ",u.user.name)))),r.a.createElement("h3",null,"comments"),r.a.createElement(I.a,{onSubmit:o},r.a.createElement("input",Object.assign({},a,{"data-cy":"comment"})),r.a.createElement(N.a,{type:"submit","data-cy":"submit"},"add comment")),r.a.createElement(G.a,{bulleted:!0,items:u.comments.map(function(e){return e})}))}),V=n(374),W=function(e){var t=e.users;return r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement(V.a,{striped:!0,celled:!0},r.a.createElement(V.a.Header,null,r.a.createElement(V.a.Row,null,r.a.createElement(V.a.HeaderCell,null),r.a.createElement(V.a.HeaderCell,null,"blogs created"))),r.a.createElement(V.a.Body,null,t.map(function(e){return r.a.createElement(V.a.Row,{key:e.id},r.a.createElement(V.a.Cell,null,r.a.createElement(z.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement(V.a.Cell,null,e.blogs.length))}))))},q=function(e){var t=e.user;return void 0===t?null:r.a.createElement("div",null,r.a.createElement("h2",null,t.name),r.a.createElement("h3",null,"added blogs"),r.a.createElement(G.a,{bulleted:!0,items:t.blogs.map(function(e){return e.title})}))},K=n(376),Q=Object(l.b)(function(e){return{user:e.user}},{setUser:S})(function(e){return null===e.user?null:r.a.createElement(K.a,{pointing:!0,secondary:!0},r.a.createElement(K.a.Item,{as:z.b,to:"/",link:!0},"blogs"),r.a.createElement(K.a.Item,{as:z.b,to:"/users"},"users"),r.a.createElement(K.a.Item,null,e.user.name," logged in",r.a.createElement(N.a,{type:"submit",onClick:function(){window.localStorage.removeItem("loggedBlogappUser"),e.setUser(null)}},"Logout")))}),X=n(44),Y=n(369);var Z={initializeBlogs:k,setUser:S},$=Object(l.b)(function(e){return{isUserNull:null===e.user,blogs:e.blogs}},Z)(function(e){var t=v("/api/users"),n=Object(f.a)(t,2),c=n[0],u=n[1];return Object(a.useEffect)(function(){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);e.setUser(n),w.setToken(n.token),e.initializeBlogs()}},[]),Object(a.useEffect)(Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.get();case 2:case"end":return e.stop()}},e)})),[]),r.a.createElement(Y.a,null,r.a.createElement(z.a,null,r.a.createElement("div",null,r.a.createElement(Q,null),r.a.createElement(E,null),r.a.createElement(X.a,{exact:!0,path:"/"},e.isUserNull?r.a.createElement(A,null):r.a.createElement(H,null)),r.a.createElement(X.a,{exact:!0,path:"/users",render:function(){return r.a.createElement(W,{users:c})}}),r.a.createElement(X.a,{exact:!0,path:"/users/:id",render:function(e){var t,n=e.match;return r.a.createElement(q,{user:(t=n.params.id,c.find(function(e){return e.id===t}))})}}),r.a.createElement(X.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match;return r.a.createElement(P,{id:t.params.id})}}))))}),ee=n(62),te=n(192),ne=Object(ee.c)({notification:j,blogs:B,user:T}),ae=Object(ee.d)(ne,Object(ee.a)(te.a));u.a.render(r.a.createElement(l.a,{store:ae},r.a.createElement($,null)),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.62c81377.chunk.js.map